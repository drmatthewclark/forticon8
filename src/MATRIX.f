C
C     FORTICON8  JANUARY 2018
C     MATTHEW CLARK

C     CALL MATRIX(13,NHS,NSS,NMD,NC,NDIM,NDIM,NDIM,NDIM,2*NDIM,
C     .NCL,NDIM,NOCC,NHDG,NDIM,NDIM,NC,NATOM,NTYPE,NHDG,NC,NC,
C     .NC,NC,NC,NC,NDIM)
C
      SUBROUTINE MATRIX(N,NS1,NS2,NS3,NS4,NS5,NS6,NS7,NS8,NS9,NS10,
     XNS11,NS12,NS13,ND1,ND2,ND3,ND4,ND5,ND6,ND7,ND8,ND9,ND10,
     XND11,ND12,ND13)
      IMPLICIT REAL*8(A-H,O-Z)
      INCLUDE 'PARAMETERS'

      DIMENSION A(2000000)
      NSIZE=2000000
C
C    SUBROUTINE TO ALLOCATE STORAGE FOR MATRICES.
C
C      CALL ERRSET(74,0,0,0,1,0)
      I1=1
      I2=I1+NS5*NS5
      I3=I2+NS5*NS5
      I4=I3+ND5
      I5=I4+NS4
      I6=I5+NS5
      I7=I6+NS6
      I8=I7+NS7
      I9=I8+NS8
      I10=I9+NS9
      I11=I10+NS4
      I12=I11+NS11
      I13=I12+NS12
      IF=I13+NS13
      IF(IF.GT.NSIZE) GO TO 200
      CALL MOVLAP (A(I1),A(I2),A(I3),A(I4),A(I5),A(I6),A(I7),
     XA(I8),A(I9),A(I10),A(I11),A(I12),A(I13),ND1,ND2,ND3,ND4,
     XND5,ND6)
      CALL HUCKEL (A(I1),A(I2),A(I3),A(I4),A(I5),A(I6),A(I7),
     XA(I8),A(I9),A(I10),A(I11),A(I12),A(I13),ND1,ND2,ND3,ND4,
     XND5,ND6)
      RETURN
 200  WRITE(6,1001) IF,NSIZE
 1001 FORMAT('*** INSUFFICIENT SPACE FOR MATRICES'/'0PROGRAM REQUESTS'
     1,I7,' DOUBLE WORDS BUT ONLY',I7,' ARE AVAILABLE'/'RECOMPILE WITH
     2LARGER DIMENSION FOR A AND INCREASED VALUE OF NSIZE')
      RETURN
      END
